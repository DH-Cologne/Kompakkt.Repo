<app-actionbar showFilters="true"
               (searchTextChange)="this.searchText = $event; this.searchTextChanged();"
               (mediaTypesChange)="this.mediaTypesSelected = $event; this.updateFilter();"
               (filterTypesChange)="this.filterTypesSelected = $event; this.updateFilter();"
               (showCompilationsChange)="this.showCompilations = $event; this.updateFilter();"
></app-actionbar>

<section class="content"
         fxFlex
         fxLayout="column">

    <div class="entity-grid" id="main">
        <div *ngFor="let element of filteredResults" class="grid-item">
            <div class="image cursor-pointer" *ngIf="isEntity(element)"
                [ngStyle]="{'background': getBackgroundColor(element)}"
                [routerLink]="['/entity', element._id]"
                matTooltip="Click to view object"
                [matTooltipShowDelay]="1000"
            >
                <anim-img [src]="getImageSource(element)" alt="{{element.name}}"></anim-img>
            </div>
            <div class="images cursor-pointer" *ngIf="isCompilation(element)"
                [routerLink]="['/compilation', element._id]"
                matTooltip="Click to view collection"
                [matTooltipShowDelay]="1000"
                [class.single-image]="getImageSources(element).length == 1"
            >
                <anim-img *ngFor="let source of getImageSources(element)" alt="{{element.name}}" [src]="source"></anim-img>
            </div>
            <div class="entity-type">
                <mat-icon class="help" *ngIf="getTooltipContent(element).length > 20" [matTooltip]="getTooltipContent(element)">description</mat-icon>

                <ng-container *ngIf="isCompilation(element)">
                    <mat-icon class="help" *ngIf="isPasswordProtected(element)" matTooltip="Password protected">lock</mat-icon>

                    <mat-icon [matTooltip]="getCollectionQuantityText(element)">{{ getCollectionQuantityIcon(element) }}</mat-icon>

                    <mat-icon class="help" matTooltip="Collection">{{icons.collection}}</mat-icon>
                </ng-container>
                <ng-container *ngIf="isEntity(element)">
                    <mat-icon class="button" matTooltip="Add to collection">playlist_add</mat-icon>
                    <mat-icon class="help" [matTooltip]="mtype[element.mediaType]">{{icons[element.mediaType]}}</mat-icon>
                </ng-container>

            </div>
            <div class="title">
                <div class="titlewrapper">
                    {{ element.name }}
                </div>
            </div>
        </div>
    </div>

    <div fxLayout="row" fxLayoutAlign="start start">
        <mat-paginator fxFlex [length]="paginatorLength" [pageSize]="paginatorPageSize" [pageSizeOptions]="[30]"
                       (page)="changePage($event)" [pageIndex]="paginatorPageIndex">
        </mat-paginator>
    </div>

</section>

