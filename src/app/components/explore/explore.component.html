<div id="fixed-navigation">
    <nav id="actionbar">
        <ul>
            <li>
                <mat-chip-list aria-label="Add content" *ngIf="isAuthenticated">
                    <mat-chip color="primary" (click)="openEntityCreation()">New Entity</mat-chip>
                    <mat-chip color="primary" (click)="openCompilationCreation()">New Collection</mat-chip>
                </mat-chip-list>
            </li>
            <li>
                <form>
                    <mat-form-field>
                        <input matInput placeholder="Search in Objects & Collections" name="search-text"
                               [(ngModel)]="searchText">
                    </mat-form-field>
                </form>
            </li>
            <li>
                <mat-checkbox color="primary"
                              [checked]="showCollections"
                              (change)="showCollections = !showCollections">Collections
                </mat-checkbox>
            </li>
            <li>
                <mat-checkbox color="primary"
                              [checked]="showEntities"
                              (change)="showEntities = !showEntities">Objects
                </mat-checkbox>
            </li>
            <li>
                <mat-form-field>
                    <mat-label>Media Types</mat-label>
                    <mat-select [formControl]="mediaTypes" multiple [(ngModel)]="selected">
                        <mat-option (onSelectionChange)="model = !model"
                                    value="showModels">3D Models
                        </mat-option>
                        <mat-option (onSelectionChange)="image = !image"
                                    value="showImages">Image
                        </mat-option>
                        <mat-option (onSelectionChange)="audio = !audio"
                                    value="showAudio">Audio
                        </mat-option>
                        <mat-option (onSelectionChange)="video = !video"
                                    value="showVideo">Video
                        </mat-option>
                    </mat-select>
                </mat-form-field>
            </li>
            <li>
                <mat-checkbox color="primary"
                              [checked]="annotated"
                              (change)="annotated = !annotated">Only Annotated
                </mat-checkbox>
            </li>
            <li>
                <mat-checkbox color="primary"
                              [checked]="showOnlyAnnotatable"
                              (change)="showOnlyAnnotatable = !showOnlyAnnotatable">Only Annotatable
                </mat-checkbox>
            </li>
            <li>
                <mat-checkbox color="primary"
                              [checked]="restricted"
                              (change)="restricted = !restricted">Only Restricted
                </mat-checkbox>
            </li>
            <li *ngIf="showEntities && !showCollections">
                <mat-checkbox color="primary"
                              [checked]="userPlaysRole"
                              (change)="userPlaysRole = !userPlaysRole">I Play a Role
                </mat-checkbox>
            </li>
            <li>
                <mat-checkbox color="primary"
                              [checked]="showOnlyMine"
                              (change)="showOnlyMine = !showOnlyMine">Only mine
                </mat-checkbox>
            <li>
            <li *ngIf="showOnlyMine">
                <mat-checkbox color="primary"
                              (change)="filter.unpublished = !filter.unpublished; updateFilter();"
                              [checked]="filter.unpublished">Unpublished
                </mat-checkbox>
            </li>
            <li *ngIf="showOnlyMine">
                <mat-checkbox color="primary"
                              [checked]="filter.unfinished"
                              (change)="filter.unfinished = !filter.unfinished; updateFilter();">Unfinished
                </mat-checkbox>
            </li>
        </ul>
    </nav>
</div>

<section class="content with-subnav"
         fxFlex
         fxLayout="column">

    <h1></h1>

    <div fxFlex="100"
         fxLayout="row"
         fxLayoutAlign="end start">

        <div fxFlex
             fxFlexFill
             fxLayout="row wrap"
             fxLayoutAlign="center start"
             fxFlexOrder="1">
            <div *ngFor="let entity of generalEntities
                | entitiesfilter:annotated:restricted:model:image:audio:video:searchText:true"
                 fxFlex="33"
                 fxFlex.xl="10"
                 fxFlex.lg="20"
                 fxFlex.sm="50"
                 fxFlex.xs="100"
                 fxLayoutGap="15px"
                 class="entity-entry">

                <mat-card fxFlex *ngIf="showEntities && !showOnlyMine"
                          [ngClass]="{'selected': selectedEntity._id === entity._id}">
                    <img mat-card-image [src]="entity.settings.preview"
                         alt="{{entity.name}}"
                         (click)="select(entity)">
                    <mat-card-title>
                        <div class="entity-type">
                            <span class="type-text">{{ entity.mediaType }}</span>
                        </div>
                        {{ entity.name }}
                    </mat-card-title>
                    <app-entity-interaction-menu [id]="entity._id"></app-entity-interaction-menu>
                </mat-card>
            </div>

            <div *ngFor="let collection of generalCompilations
                | entitiesfilter:annotated:restricted:model:image:audio:video:searchText:false"
                 fxFlex="33"
                 fxFlex.xl="10"
                 fxFlex.lg="20"
                 fxFlex.sm="50"
                 fxFlex.xs="100"
                 fxLayoutGap="15px"
                 class="entity-entry">
                <mat-card *ngIf="showCollections && !showOnlyMine"
                          [ngClass]="{'selected': selectedEntity._id === collection._id}">
                    <img mat-card-image [src]="collection.entities[0].settings.preview"
                         alt="{{collection.name}}"
                         (click)="select(collection)">
                    <mat-card-title>
                        <div class="entity-type">
                            <mat-icon>apps</mat-icon>
                            <span class="type-text">Collection</span>
                        </div>
                        {{ collection.name }}
                    </mat-card-title>
                    <app-entity-interaction-menu [id]="collection._id"></app-entity-interaction-menu>
                </mat-card>
            </div>

            <div *ngFor="let entity of personalEntities
                | entitiesfilter:annotated:restricted:model:image:audio:video:searchText:true"
                 fxFlex="33"
                 fxFlex.xl="10"
                 fxFlex.lg="20"
                 fxFlex.sm="50"
                 fxFlex.xs="100"
                 fxLayoutGap="15px"
                 class="entity-entry">
                <mat-card fxFlex *ngIf="!showEntities && showOnlyMine"
                          [ngClass]="{'selected': selectedEntity._id === entity._id}">
                    <img mat-card-image [src]="entity.settings.preview"
                         alt="{{entity.name}}"
                         (click)="select(entity)">
                    <mat-card-title>
                        <div class="entity-type">
                            <span class="type-text">{{ entity.mediaType }}</span>
                        </div>
                        {{ entity.name }}
                    </mat-card-title>
                    <app-entity-interaction-menu [id]="entity._id"></app-entity-interaction-menu>
                </mat-card>
            </div>

        </div>

        <div fxFlex="50"
             fxFlexOrder="2"
             *ngIf="selectedEntity">
            <div fxLayout="row"
                 class="entity-details">
                <div fxFlex="50"
                     [fxHide]="!selectedEntity">
                    <h2>Details</h2>
                    <h3>{{selectedEntity.name}}</h3>
                    <p>{{selectedEntity.relatedDigitalEntity.description}}</p>
                    <h2>Licensing</h2>
                    {{selectedEntity.relatedDigitalEntity.licence}}
                </div>
                <div fxFlex="50">
                    <h2>Kompakkt Infos</h2>
                    <ul>
                        <li>ID: {{selectedEntity._id}}</li>
                        <li>Created: n</li>
                        <li>Used in n Collections</li>
                        <li>Has n Annotations</li>
                        <li>Connected to n Objects in Kompakkt</li>
                    </ul>
                </div>
            </div>
        </div>

    </div>

</section>
