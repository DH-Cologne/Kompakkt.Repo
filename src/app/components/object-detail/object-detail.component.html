<main *ngIf="objectReady"
      fxLayout="row"
      fxLayout.xs="column"
      fxLayoutGap="5px"
      class="main-padding">

  <div fxFlexOrder="2"
       fxFlex="30%"
       class="iframe-container main-padding"
       [style.width]="viewer.width"
       [style.height]="viewer.height">
    <iframe [src]="viewerUrl | safe: 'resourceUrl'"
            allowfullscreen></iframe>
  </div>

  <div fxFlexOrder="1"
       fxFlexOrder.gt-sm="2"
       fxFlex="70%">

    <div id="digital-object-obligatory-metadata">

      <!-- Obligatory Metadata Digital Object -->
      <h1 [innerHTML]="object.title"></h1>

      <a title="Download Object Metadata"
         [href]="downloadJsonHref"
         download="obj-{{objectID}}.json"
         (click)="generateDownloadJsonUri();">
        Download JSON
      </a>

      <p [innerHTML]="object.description"></p>

      <!-- Rights Owner -->
      {{'metadata.licence' | translate}}: <span [innerHTML]="object.licence"></span>

      <div id="rights-owner">
        <h2 [innerHTML]="'metadata.rightsowner' | translate"></h2>

        <div *ngFor="let owner of getEntityPersonByRole(object, 'RIGHTS_OWNER')">

          <div *ngIf="owner.name">
            {{owner.prename}} {{owner.name}}<br>
            {{owner.email}}<br>
            {{owner.phonenumber}}
            <p *ngIf="owner.note">
              {{'metadata.person-note' | translate}}<br>
              {{owner.note}}
            </p>
          </div>
          <!-- ToDo: one to one or one to many relationship of owner.person_institution[0]['value']? -->
          <div *ngFor="let inst of owner.institution">
            <div *ngIf="inst.name">
              {{inst.name}}<br>
              {{inst.university}}<br>
              {{inst.address.street}} {{inst.address.number}}<br>
              {{inst.address.postcode}} {{inst.address.city}}<br>
              {{inst.address.country}}
            </div>

            <div *ngIf="inst.note">
              {{'metadata.institution-note' | translate}}: {{inst.note}}
            </div>
          </div>
        </div>

        <div *ngFor="let owner of getEntityInstitutionByRole(object, 'RIGHTS_OWNER')">
          <div *ngIf="owner.name">
            {{owner.name}}<br>
            {{owner.university}}<br>
            {{owner.address.street}} {{owner.address.number}}<br>
            {{owner.address.postcode}} {{owner.address.city}}<br>
            {{owner.address.country}}
          </div>

          <div *ngIf="owner.note">
            {{'metadata.institution-note' | translate}}: {{owner.note}}
          </div>
        </div>
      </div>
      <!-- / Rights Owner -->

      <!-- Contact Person -->
      <div id="contact-person"
           *ngIf="getEntityPersonByRole(object, 'CONTACT_PERSON').length > 0">

        <h2 [innerHTML]="'metadata.contact' | translate"></h2>
        <div
          *ngFor="let contact of getEntityPersonByRole(object, 'CONTACT_PERSON')">
          {{contact.prename}} {{contact.name}}<br>
          {{contact.email}}<br>
          {{contact.phonenumber}}
        </div>
      </div>
      <!-- /Contact Person -->
    </div>
    <!-- /Obligatory Metadata Digital Object -->

    <!-- Facultative Metadata Digital Object -->
    <div id="digital-object-facultative-metadata">

      <h2 [innerHTML]="'metadata.optional' | translate"></h2>

      <div *ngIf="object.discipline.length > 0">
        <h3 [innerHTML]="'metadata.discipline' | translate"></h3>
        <mat-chip-list>
          <mat-chip *ngFor="let disc of object.discipline"
                    [innerHTML]="disc"></mat-chip>
        </mat-chip-list>
      </div>

      <div *ngIf="object.tags.length > 0">
        <h3>Tags</h3>
        <mat-chip-list>
          <mat-chip *ngFor="let tag of object.tags"
                    [innerHTML]="tag.value"></mat-chip>
        </mat-chip-list>
      </div>

      <div *ngIf="object.objecttype.length > 0">
        <h3 [innerHTML]="'metadata.objecttype' | translate"></h3>
        {{object.objecttype}}
      </div>

      <div *ngIf="object.externalId.length > 0">
        <h3 [innerHTML]="'metadata.id' | translate"></h3>
        <div *ngFor="let identifier of object.externalId">
          {{'metadata.id-type' | translate}}: {{identifier.type}}<br>
          {{'metadata.id-value' | translate}}: {{identifier.value}}
        </div>
      </div>

      <div *ngIf="object.dimensions.length > 0">
        <h3 [innerHTML]="'metadata.dimensions' | translate"></h3>
        <div *ngFor="let dimension of object.dimensions">
          {{'metadata.dimensions-type' | translate}}: {{dimension.type}}<br>
          {{'metadata.dimensions-value' | translate}}: {{dimension.value}}<br>
          {{'metadata.dimensions-name' | translate}}: {{dimension.name}}
        </div>
      </div>

      <div *ngIf="object.creation.length > 0">
        <h3 [innerHTML]="'metadata.creation' | translate"></h3>
        <div *ngFor="let creation of object.creation">
          {{'metadata.creation-technique' | translate}}: {{creation.technique}}<br>
          {{'metadata.creation-program' | translate}}: {{creation.program}}<br>
          {{'metadata.creation-equipment' | translate}}: {{creation.equipment}}<br>
          {{'metadata.creation-date' | translate}}: {{creation.date}}<br>
        </div>
      </div>

      <!-- TODO: filter CONTACT_PERSON & RIGHTS_OWNER -->
      <div *ngIf="object.persons && object.persons.length > 0">
        <!-- ToDo Translate -->
        <h3>Person</h3>
        <div *ngFor="let person of object.persons">
          {{person.prename}} {{person.name}}<br>
          {{person.email}}<br>
          {{'metadata.person-phone' | translate}}: {{person.phonenumber}}<br>
          <!-- TODO: Role as chips? -->
          {{'metadata.person-role' | translate}}: {{person.roles[object._id]}}<br>
          {{'metadata.person-note' | translate}}: {{person.note}}
        </div>
      </div>

      <div *ngIf="object.externalLink.length > 0">
        <h3 [innerHTML]="'metadata.link' | translate"></h3>
        <div *ngFor="let link of object.externalLink">
          {{'metadata.link-description' | translate}}: {{link.description}}
          {{'metadata.link-value' | translate}}: {{link.value}}
        </div>
      </div>

      <!-- ToDo Check if link is correct -->
      <div *ngIf="object.metadata_files.length > 0">
        <h3 [innerHTML]="'metadata.external' | translate"></h3>
        <a [href]="object.metadata_files[0]['metadata_file_link']" download>
          {{'metadata.download-metadata' | translate}}
        </a>
      </div>

      <div *ngIf="object.statement.length > 0">
        <!-- ToDo Translate -->
        <h3>Statement</h3>
        <div [innerHTML]="object.statement"></div>
      </div>

    </div>
    <!-- /Facultative Metadata Digital Object -->

    <!-- Metadata Physical Object -->
    <div id="physical-object-obligatory-metadata"
         *ngIf="object.phyObjs.length > 0">

      <div *ngFor="let obj of object.phyObjs">

        <h2>{{'metadata.phy-obligatory-p2' | translate}}</h2>

        <h3 [innerHTML]="obj.title"></h3>
        <p [innerHTML]="obj.description"></p>

        <!-- TODO: Adjust to new data model -->
        <div id="physical-object-rights-owner">

          <h2 [innerHTML]="'metadata.rightsowner' | translate"></h2>

          <div *ngFor="let owner of getEntityPersonByRole(obj, 'RIGHTS_OWNER')">
            <div *ngIf="owner.name">
              {{owner.prename}} {{owner.name}}<br>
              {{owner.email}}<br>
              {{owner.phonenumber}}
              <p *ngIf="owner.note">
                {{'metadata.person-note' | translate}}<br>
                {{owner.note}}
              </p>
            </div>
          </div>
          <div *ngFor="let owner of getEntityInstitutionByRole(obj, 'RIGHTS_OWNER')">
            <!-- ToDo: one to one or one to many relationship of owner.person_institution[0]['value']? -->
            <div *ngIf="owner.institution && owner.institution[0]['value'] !== 'add_new_institution'">
              {{owner.institution[0].display}}<br>
              {{owner.institution[0].institution_name}}
            </div>

            <div *ngIf="owner.institution_name">
              {{owner.institution_name}}<br>
              {{owner.institution_university}}<br>
              {{owner.institution_address.address_street}} {{owner.institution_address.address_number}}<br>
              {{owner.institution_address.address_postcode}} {{owner.institution_address.address_city}}<br>
              {{owner.institution_address.address_country}}
            </div>

            <div *ngIf="owner.institution_note">
              {{'metadata.institution-note' | translate}}: {{owner.institution_note}}
            </div>
          </div>

          <div *ngIf="obj.externalId.length > 0">
            <h3 [innerHTML]="'metadata.id' | translate"></h3>
            <div *ngFor="let identifier of obj.externalId">
              {{'metadata.id-type' | translate}}: {{identifier.externalId_type}}<br>
              {{'metadata.id-value' | translate}}: {{identifier.externalId_value}}
            </div>
          </div>

          <div *ngIf="obj.externalLink.length > 0">
            <h3 [innerHTML]="'metadata.link' | translate"></h3>
            <div *ngFor="let link of obj.externalLink">
              {{'metadata.link-description' | translate}}: {{link.externalLink_description}}
              {{'metadata.link-value' | translate}}: {{link.externalLink_value}}
            </div>
          </div>

          <div *ngIf="obj.place.length > 0">
            <h3 [innerHTML]="'metadata.place' | translate"></h3>
            <div *ngFor="let place of obj.place">
              {{place.placename}}<br>
              {{place.address.address_building}}<br>
              {{place.address.address_street}}
              {{place.address.address_number}}<br>
              {{place.address.address_postcode}} {{place.address.address_city}}<br>
              {{place.address.address_country}}

              {{place.place_geopolarea}}
            </div>
          </div>

          <!-- TODO: only contact or all? -->
          <div *ngIf="obj.persons.length > 0">

            <h2 [innerHTML]="'metadata.contact' | translate"></h2>
            <div
              *ngFor="let contact of obj.persons">
              {{contact.prename}} {{contact.name}}<br>
              {{contact.email}}<br>
              {{contact.phonenumber}}
            </div>
          </div>

          <!-- ToDo Check consistency -->
          <div *ngIf="obj.institutions.length > 0">
            <div *ngFor="let institution of obj.institutions">
              {{'metadata.institute' | translate}}:
              {{institution.name}}
              {{'metadata.address' | translate}}:
              {{institution.address.street}}
              {{institution.address.number}}
              ,
              {{institution.address.postcode}}
              {{institution.address.city}}
              {{'metadata.institution-building' | translate}}:
              {{institution.address.building}}
              {{'metadata.institution-country' | translate}}:
              {{institution.address.country}}
              {{'metadata.institution-role' | translate}}:
              {{institution.roles[obj._id]}}
              {{'metadata.institution-university' | translate}}:
              {{institution.university}}
              {{'metadata.institution-note' | translate}}:
              {{institution.note}}
            </div>
          </div>

          <div *ngIf="obj.collection">
            <h3 [innerHTML]="'metadata.collection' | translate"></h3>
            <div [innerHTML]="obj.collection"></div>
          </div>

        </div>

      </div>
    </div>
    <!-- /Metadata Physical Object -->

  </div>

</main>


